<html>
<head>
<title>Crash [@ nsTypedSelection::ScrollPointIntoClipView] with toggling iframe, mousedown and mousemove</title>
</head>
<body>
Moving with you mouse from above to below and back a few times across the iframe, shouldn't crash Mozilla<br>
<iframe id="content" src="data:text/html;charset=utf-8,text%3Cbr%3Etext%3Cbr%3Etext%3Cbr%3Etext%3Cbr%3Etext%3Cbr%3Etext%3Cbr%3Etext%3Cbr%3Etext%3Cbr%3Etext%3Cbr%3Etext%3Cbr%3Etext%3Cbr%3Etext%0A%3Cbr%3Etext%3Cbr%3Etext%3Cbr%3Etext%3Cbr%3Etext%3Cbr%3Etext%3Cbr%3Etext%3Cbr%3Etext%3Cbr%3Etext%3Cbr%3Etext%3Cbr%3Etext%3Cbr%3E"></iframe>
<script>
var doc = document;
if (document.getElementById('content'))
  doc = document.getElementById('content').contentDocument;

function toggleIframe(){
 netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect UniversalBrowserRead");
var x=top.document.getElementById('content');
x.style.display = x.style.display == 'none' ? x.style.display = '' : x.style.display = 'none';
setTimeout(toggleIframe,100);
}
setTimeout(toggleIframe,100);

function ctrlclick(i){
netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
var wu =  doc.defaultView.QueryInterface(Components.interfaces.nsIInterfaceRequestor)
                .getInterface(Components.interfaces.nsIDOMWindowUtils);

var wu2 =  top.QueryInterface(Components.interfaces.nsIInterfaceRequestor)
                .getInterface(Components.interfaces.nsIDOMWindowUtils);

try{
wu.sendMouseEvent('mousedown',  2*i, 2*i, 0, 1, 0);
wu2.sendMouseEvent('mousemove',  500*i, 500*i, 0, 0, 0);
//wu.sendMouseEvent('mouseup',  2*i, 2*i, 0, 1, 2);

} catch(e) {}
i+=1;
if (i>50)
 i =0;
setTimeout(ctrlclick,20,i);
}
setTimeout(ctrlclick,20,0);
</script>
</body>
</html>
