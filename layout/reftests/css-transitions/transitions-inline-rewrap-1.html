<html class="reftest-wait">
<title>Test for CSS transitions and re-wrapping of inlines</title>
<style type="text/css">
#test { -moz-transition: 5s color linear 200s; }
</style>
<script type="text/javascript">

window.onload = run;

function run() {
  var test = document.getElementById("test");
  var unused = test.offsetWidth;
  // FIXME: It's a bug that we need to do this at all: the way we change
  // style data essentially violates style rule immutability because we
  // assume that all of the difference calculation will use
  // PeekStyleData, which is no longer true with transitions.
  // See the FIXME in nsTransitionManager::ConsiderStartingTransition.
  unused = getComputedStyle(test, "").color;
  test.style.color = "red";
  unused = test.offsetWidth;
  unused = getComputedStyle(test, "").color;
  test.parentNode.style.width = "3em";
  unused = test.offsetWidth;
  unused = getComputedStyle(test, "").color;
  document.documentElement.removeAttribute("class");
}

</script>
<div style="width: 50em">
<span id="test" style="color: green">
This is some text with a transition.
</span>
</div>
