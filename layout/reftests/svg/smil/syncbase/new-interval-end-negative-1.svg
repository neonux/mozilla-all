<svg xmlns="http://www.w3.org/2000/svg"
     xmlns:xlink="http://www.w3.org/1999/xlink"
     class="reftest-wait"
     onload="setTimeAndSnapshot(2, true)">
  <script xlink:href="../smil-util.js" type="text/javascript"/>
  <!--
    Test a dependency with a negative offset that occurs at the end of another
    interval.

    This is one of the most important tests in the suite.

    REALLY IMPORTANT: If an interval ends and a new instance time is generated
    before the end of the last interval it is IGNORED. However, if the instance
    time is generated BEFORE the interval ends, and restart="always", a new
    interval will be generated and the animation will restart.

    So, if a new instance time is generated at the same time as an interval is
    due to end what should happen? SMIL's endpoint-exclusive timing seems to
    imply that interval ends should be processed first and hence the new
    instance time should be ignored. Opera, WebKit and Batik seem to agree on
    this.

    Hence why this test is so important. It tests that we are actually
    processing ends first.
   -->
  <rect width="100" height="100" fill="red">
    <animate attributeName="y" attributeType="XML" from="0" to="0" id="a"
      begin="0s; 1.5s" dur="1.5s"/>
    <animate attributeName="fill" attributeType="CSS"
      values="orange; green" fill="freeze"
      begin="a.begin-0.5s" dur="2s"/>
  </rect>
</svg>
